O(k^2 * log N) works where k ~ 2000 and N ~ 1e9
